# Changelog

## [1.2.3] - 2025-09-08

### Удалено
- Удалены бесполезные сенсоры истории потребления (API не предоставляет эти данные):
  - KSKLastConsumptionSensor
  - KSKMonthlyConsumptionSensor  
  - KSKAverageConsumptionSensor
- Удален KSKLastPaymentSensor (API не предоставляет payment_history)

### Оптимизировано  
- Убраны ненужные API запросы к consumption_history и payment_history
- Уменьшено количество HTTP запросов при обновлении данных
- Упрощена структура данных координатора

### Техническое
- Удалены неиспользуемые методы _get_consumption_history() и _get_payment_history()
- Удалены константы API_CONSUMPTION_HISTORY_URL и API_PAYMENT_HISTORY_URL
- Оставлены только рабочие endpoints: meter_history работает отлично

## [1.2.2] - 2025-09-08

### Удалено
- Удален дублирующийся KSKPaymentAmountSensor (показывал ту же сумму что и KSKBalanceSensor)
- Удален дублирующийся KSKPaymentDetailsSensor (показывал ту же сумму что и KSKBalanceSensor)

### Техническое
- Убраны избыточные сенсоры, дублирующие функциональность KSKBalanceSensor
- Оптимизирован список сенсоров, теперь меньше путаницы в интерфейсе

## [1.2.1] - 2025-09-08

### Исправлено
- Исправлен сенсор потребления: заменен на сенсор "Сумма к доплате" с правильными единицами измерения (RUB вместо кВт⋅ч)
- Сенсор теперь корректно показывает сумму к доплате из API, а не путает ее с потреблением

### Техническое
- KSKConsumptionSensor переименован в KSKPaymentAmountSensor
- Изменены единицы измерения с UnitOfEnergy.KILO_WATT_HOUR на RUB
- Изменен device_class с ENERGY на MONETARY

## [1.2.0] - 2025-09-08

### Добавлено
- Поддержка нескольких лицевых счетов в одной учетной записи
- Автоматическое создание отдельных устройств для каждого лицевого счета
- Индивидуальные сенсоры для каждого лицевого счета

### Изменено
- Полностью переработана структура данных координатора для поддержки множественных лицевых счетов
- Каждый сенсор теперь работает с данными конкретного лицевого счета
- Улучшена архитектура получения данных через API

### Исправлено
- Проблема с отображением данных только первого лицевого счета
- Корректная работа всех сенсоров для каждого счета отдельно
- Правильное формирование уникальных идентификаторов устройств

### Техническое
- Добавлен метод `get_account_details()` в базовый класс сенсоров
- Координатор теперь получает данные для всех лицевых счетов одновременно
- Новая структура данных: `accounts_details[account_id][data_type]`

## [1.1.3] - Предыдущие версии
- Базовая функциональность интеграции КСК
